mutate(status = factor(status, levels = c("Native","Non-native")))
# Chequeo de totales (revísalos con tus sumas)
df_period  |> group_by(period) |> summarise(total = sum(n))
df_status  |> group_by(status) |> summarise(total = sum(n))
# --- 3) Estilo ---------------------------------------------
pal_period <- c("Before (1840–1880)" = "#C08C8C", "After (1960–2000)" = "#E8CF8C")
theme_thesis <- theme_minimal(base_size = 13) +
theme(
plot.title    = element_text(face="bold", hjust=0.5, margin=margin(b=6)),
plot.subtitle = element_text(hjust=0.5, color="#555", margin=margin(b=10)),
axis.title.y  = element_text(margin=margin(r=8)),
axis.text.x   = element_text(face="bold"),
panel.grid.major.y = element_line(linetype="dashed", color="gray55", linewidth=0.7),
panel.grid.minor = element_blank(),
legend.position = "top",
legend.title = element_blank(),
plot.background = element_rect(fill = "#F0F4F8", color = NA)
)
# --- 4) Figuras --------------------------------------------
# A) Barras lado a lado por periodo
p_c_bars <- ggplot(df_period, aes(x = factor(C), y = n, fill = period)) +
geom_col(position = position_dodge(width = 0.8), width = 0.7, color = "white") +
geom_text(aes(label = n),
position = position_dodge(width = 0.8), vjust = -0.35, size = 3.2) +
scale_fill_manual(values = pal_period) +
labs(title = "C value distribution by period",
subtitle = "Before (1840–1880) vs After (1960–2000)",
x = "C value", y = "Count") +
theme_thesis
# B) Polígonos de frecuencia (líneas)
p_c_lines <- ggplot(df_period, aes(x = C, y = n, color = period)) +
geom_point(size = 2) +
geom_line(linewidth = 1) +
scale_x_continuous(breaks = C_vals) +
scale_color_manual(values = pal_period) +
labs(title = "C value frequency polygons by period",
subtitle = "Comparación de forma de las distribuciones",
x = "C value", y = "Count") +
theme_thesis
# (Opcional) C value por estatus
pal_status <- c("Native"="#9FD29F", "Non-native"="#79B7FF")
p_c_status <- ggplot(df_status, aes(x = factor(C), y = n, fill = status)) +
geom_col(position = position_dodge(width = 0.8), width = 0.7, color = "white") +
geom_text(aes(label = n),
position = position_dodge(width = 0.8), vjust = -0.35, size = 3.2) +
scale_fill_manual(values = pal_status) +
labs(title = "C value distribution by status",
subtitle = "Native vs Non-native",
x = "C value", y = "Count") +
theme_thesis
# Mostrar
p_c_bars
p_c_lines
p_c_status  # comenta si no quieres esta tercera figura
# --- 5) Prueba Chi-cuadrado de distribuciones por periodo ---
# (¿La forma de la distribución de C difiere entre Before y After?)
chisq_c <- chisq.test(rbind(before_counts, after_counts))
chisq_c
# Puedes reportar: X^2, df = length(C_vals)-1, p-value
# --- 6) Guardar (opcional) ---------------------------------
dir.create("outputs", showWarnings = FALSE)
# --- 1) Ingreso de datos -----------------------------------
C_vals <- 0:10
# Periodos (de tu tabla; vacíos tratados como 0)
before_counts <- c(9, 0, 1, 2, 0, 3, 2, 7, 4, 6, 0)   # C=0..10
after_counts  <- c(37,0,10,1,11,6,11,12,7,6,2)      # C=0..10
# Estatus (de tu tabla; vacíos tratados como 0)
native_counts     <- c(0,0,10,3,11,9,13,19,11,12,1)  # C=0..10
non_native_counts <- c(46,1,0,0,0,0,0,0,0,0,1)       # C=0..10
# --- 2) Data frames "tidy" ---------------------------------
df_period <- tibble(
C = rep(C_vals, 2),
period = rep(c("Before (1840–1880)", "After (1960–2000)"), each = length(C_vals)),
n = c(before_counts, after_counts)
) |>
mutate(period = factor(period, levels = c("Before (1840–1880)", "After (1960–2000)")))
df_status <- tibble(
C = rep(C_vals, 2),
status = rep(c("Native", "Non-native"), each = length(C_vals)),
n = c(native_counts, non_native_counts)
) |>
mutate(status = factor(status, levels = c("Native","Non-native")))
# Chequeo de totales (revísalos con tus sumas)
df_period  |> group_by(period) |> summarise(total = sum(n))
df_status  |> group_by(status) |> summarise(total = sum(n))
# --- 3) Estilo ---------------------------------------------
pal_period <- c("Before (1840–1880)" = "#C08C8C", "After (1960–2000)" = "#E8CF8C")
theme_thesis <- theme_minimal(base_size = 13) +
theme(
plot.title    = element_text(face="bold", hjust=0.5, margin=margin(b=6)),
plot.subtitle = element_text(hjust=0.5, color="#555", margin=margin(b=10)),
axis.title.y  = element_text(margin=margin(r=8)),
axis.text.x   = element_text(face="bold"),
panel.grid.major.y = element_line(linetype="dashed", color="gray55", linewidth=0.7),
panel.grid.minor = element_blank(),
legend.position = "top",
legend.title = element_blank(),
plot.background = element_rect(fill = "#F0F4F8", color = NA)
)
# --- 4) Figuras --------------------------------------------
# A) Barras lado a lado por periodo
p_c_bars <- ggplot(df_period, aes(x = factor(C), y = n, fill = period)) +
geom_col(position = position_dodge(width = 0.8), width = 0.7, color = "white") +
geom_text(aes(label = n),
position = position_dodge(width = 0.8), vjust = -0.35, size = 3.2) +
scale_fill_manual(values = pal_period) +
labs(title = "C value distribution by period",
subtitle = "Before (1840–1880) vs After (1960–2000)",
x = "C value", y = "Count") +
theme_thesis
# B) Polígonos de frecuencia (líneas)
p_c_lines <- ggplot(df_period, aes(x = C, y = n, color = period)) +
geom_point(size = 2) +
geom_line(linewidth = 1) +
scale_x_continuous(breaks = C_vals) +
scale_color_manual(values = pal_period) +
labs(title = "C value frequency polygons by period",
subtitle = "Comparación de forma de las distribuciones",
x = "C value", y = "Count") +
theme_thesis
# (Opcional) C value por estatus
pal_status <- c("Native"="#9FD29F", "Non-native"="#79B7FF")
p_c_status <- ggplot(df_status, aes(x = factor(C), y = n, fill = status)) +
geom_col(position = position_dodge(width = 0.8), width = 0.7, color = "white") +
geom_text(aes(label = n),
position = position_dodge(width = 0.8), vjust = -0.35, size = 3.2) +
scale_fill_manual(values = pal_status) +
labs(title = "C value distribution by status",
subtitle = "Native vs Non-native",
x = "C value", y = "Count") +
theme_thesis
# Mostrar
p_c_bars
p_c_lines
p_c_status  # comenta si no quieres esta tercera figura
# --- 5) Prueba Chi-cuadrado de distribuciones por periodo ---
# (¿La forma de la distribución de C difiere entre Before y After?)
chisq_c <- chisq.test(rbind(before_counts, after_counts))
chisq_c
# Puedes reportar: X^2, df = length(C_vals)-1, p-value
# --- 6) Guardar (opcional) ---------------------------------
dir.create("outputs", showWarnings = FALSE)
# --- 1) Ingreso de datos -----------------------------------
C_vals <- 0:10
# Periodos (de tu tabla; vacíos tratados como 0)
before_counts <- c(9, 0, 1, 2, 0, 3, 2, 7, 4, 6, 0)   # C=0..10
after_counts  <- c(37,0,10,1,11,6,11,12,7,6,2)      # C=0..10
# Estatus (de tu tabla; vacíos tratados como 0)
native_counts     <- c(0,0,10,3,11,9,13,19,11,12,1)  # C=0..10
non_native_counts <- c(46,1,0,0,0,0,0,0,0,0,1)       # C=0..10
# --- 2) Data frames "tidy" ---------------------------------
df_period <- tibble(
C = rep(C_vals, 2),
period = rep(c("Before (1840–1880)", "After (1960–2000)"), each = length(C_vals)),
n = c(before_counts, after_counts)
) |>
mutate(period = factor(period, levels = c("Before (1840–1880)", "After (1960–2000)")))
df_status <- tibble(
C = rep(C_vals, 2),
status = rep(c("Native", "Non-native"), each = length(C_vals)),
n = c(native_counts, non_native_counts)
) |>
mutate(status = factor(status, levels = c("Native","Non-native")))
# Chequeo de totales (revísalos con tus sumas)
df_period  |> group_by(period) |> summarise(total = sum(n))
df_status  |> group_by(status) |> summarise(total = sum(n))
# --- 3) Estilo ---------------------------------------------
pal_period <- c("Before (1840–1880)" = "#C08C8C", "After (1960–2000)" = "#E8CF8C")
theme_thesis <- theme_minimal(base_size = 13) +
theme(
plot.title    = element_text(face="bold", hjust=0.5, margin=margin(b=6)),
plot.subtitle = element_text(hjust=0.5, color="#555", margin=margin(b=10)),
axis.title.y  = element_text(margin=margin(r=8)),
axis.text.x   = element_text(face="bold"),
panel.grid.major.y = element_line(linetype="dashed", color="gray55", linewidth=0.7),
panel.grid.minor = element_blank(),
legend.position = "top",
legend.title = element_blank(),
plot.background = element_rect(fill = "#F0F4F8", color = NA)
)
# --- 4) Figuras --------------------------------------------
# A) Barras lado a lado por periodo
p_c_bars <- ggplot(df_period, aes(x = factor(C), y = n, fill = period)) +
geom_col(position = position_dodge(width = 0.8), width = 0.7, color = "white") +
geom_text(aes(label = n),
position = position_dodge(width = 0.8), vjust = -0.35, size = 3.2) +
scale_fill_manual(values = pal_period) +
labs(title = "C value distribution by period",
subtitle = "Before (1840–1880) vs After (1960–2000)",
x = "C value", y = "Count") +
theme_thesis
# B) Polígonos de frecuencia (líneas)
p_c_lines <- ggplot(df_period, aes(x = C, y = n, color = period)) +
geom_point(size = 2) +
geom_line(linewidth = 1) +
scale_x_continuous(breaks = C_vals) +
scale_color_manual(values = pal_period) +
labs(title = "C value frequency polygons by period",
subtitle = "Comparación de forma de las distribuciones",
x = "C value", y = "Count") +
theme_thesis
# (Opcional) C value por estatus
pal_status <- c("Native"="#9FD29F", "Non-native"="#79B7FF")
p_c_status <- ggplot(df_status, aes(x = factor(C), y = n, fill = status)) +
geom_col(position = position_dodge(width = 0.8), width = 0.7, color = "white") +
geom_text(aes(label = n),
position = position_dodge(width = 0.8), vjust = -0.35, size = 3.2) +
scale_fill_manual(values = pal_status) +
labs(title = "C value distribution by status",
subtitle = "Native vs Non-native",
x = "C value", y = "Count") +
theme_thesis
# Mostrar
p_c_bars
p_c_lines
p_c_status  # comenta si no quieres esta tercera figura
# --- 5) Prueba Chi-cuadrado de distribuciones por periodo ---
# (¿La forma de la distribución de C difiere entre Before y After?)
chisq_c <- chisq.test(rbind(before_counts, after_counts))
chisq_c
# Puedes reportar: X^2, df = length(C_vals)-1, p-value
# --- 6) Guardar (opcional) ---------------------------------
dir.create("outputs", showWarnings = FALSE)
# --- 1) Ingreso de datos -----------------------------------
C_vals <- 0:10
# Periodos (de tu tabla; vacíos tratados como 0)
before_counts <- c(9, 0, 1, 2, 0, 3, 2, 7, 4, 6, 0)   # C=0..10
after_counts  <- c(37,0,10,1,11,6,11,12,7,6,2)      # C=0..10
# Estatus (de tu tabla; vacíos tratados como 0)
native_counts     <- c(0,0,10,3,11,9,13,19,11,12,1)  # C=0..10
non_native_counts <- c(46,1,0,0,0,0,0,0,0,0,1)       # C=0..10
# --- 2) Data frames "tidy" ---------------------------------
df_period <- tibble(
C = rep(C_vals, 2),
period = rep(c("Before (1840–1880)", "After (1960–2000)"), each = length(C_vals)),
n = c(before_counts, after_counts)
) |>
mutate(period = factor(period, levels = c("Before (1840–1880)", "After (1960–2000)")))
df_status <- tibble(
C = rep(C_vals, 2),
status = rep(c("Native", "Non-native"), each = length(C_vals)),
n = c(native_counts, non_native_counts)
) |>
mutate(status = factor(status, levels = c("Native","Non-native")))
# Chequeo de totales (revísalos con tus sumas)
df_period  |> group_by(period) |> summarise(total = sum(n))
df_status  |> group_by(status) |> summarise(total = sum(n))
# --- 3) Estilo ---------------------------------------------
pal_period <- c("Before (1840–1880)" = "#C08C8C", "After (1960–2000)" = "#E8CF8C")
theme_thesis <- theme_minimal(base_size = 13) +
theme(
plot.title    = element_text(face="bold", hjust=0.5, margin=margin(b=6)),
plot.subtitle = element_text(hjust=0.5, color="#555", margin=margin(b=10)),
axis.title.y  = element_text(margin=margin(r=8)),
axis.text.x   = element_text(face="bold"),
panel.grid.major.y = element_line(linetype="dashed", color="gray55", linewidth=0.7),
panel.grid.minor = element_blank(),
legend.position = "top",
legend.title = element_blank(),
plot.background = element_rect(fill = "#F0F4F8", color = NA)
)
# --- 4) Figuras --------------------------------------------
# A) Barras lado a lado por periodo
p_c_bars <- ggplot(df_period, aes(x = factor(C), y = n, fill = period)) +
geom_col(position = position_dodge(width = 0.8), width = 0.7, color = "white") +
geom_text(aes(label = n),
position = position_dodge(width = 0.8), vjust = -0.35, size = 3.2) +
scale_fill_manual(values = pal_period) +
labs(title = "C value distribution by period",
subtitle = "Before (1840–1880) vs After (1960–2000)",
x = "C value", y = "Count") +
theme_thesis
# B) Polígonos de frecuencia (líneas)
p_c_lines <- ggplot(df_period, aes(x = C, y = n, color = period)) +
geom_point(size = 2) +
geom_line(linewidth = 1) +
scale_x_continuous(breaks = C_vals) +
scale_color_manual(values = pal_period) +
labs(title = "C value frequency polygons by period",
subtitle = "Comparación de forma de las distribuciones",
x = "C value", y = "Count") +
theme_thesis
# (Opcional) C value por estatus
pal_status <- c("Native"="#9FD29F", "Non-native"="#79B7FF")
p_c_status <- ggplot(df_status, aes(x = factor(C), y = n, fill = status)) +
geom_col(position = position_dodge(width = 0.8), width = 0.7, color = "white") +
geom_text(aes(label = n),
position = position_dodge(width = 0.8), vjust = -0.35, size = 3.2) +
scale_fill_manual(values = pal_status) +
labs(title = "C value distribution by status",
subtitle = "Native vs Non-native",
x = "C value", y = "Count") +
theme_thesis
# Mostrar
p_c_bars
p_c_lines
p_c_status  # comenta si no quieres esta tercera figura
# --- 1) Ingreso de datos -----------------------------------
C_vals <- 0:10
# Periodos (de tu tabla; vacíos tratados como 0)
before_counts <- c(9, 0, 1, 2, 0, 3, 2, 7, 4, 6, 0)   # C=0..10
after_counts  <- c(37,0,10,1,11,6,11,12,7,6,2)      # C=0..10
# Estatus (de tu tabla; vacíos tratados como 0)
native_counts     <- c(0,0,10,3,11,9,13,19,11,12,1)  # C=0..10
non_native_counts <- c(46,1,0,0,0,0,0,0,0,0,1)       # C=0..10
# --- 2) Data frames "tidy" ---------------------------------
df_period <- tibble(
C = rep(C_vals, 2),
period = rep(c("Before (1840–1880)", "After (1960–2000)"), each = length(C_vals)),
n = c(before_counts, after_counts)
) |>
mutate(period = factor(period, levels = c("Before (1840–1880)", "After (1960–2000)")))
df_status <- tibble(
C = rep(C_vals, 2),
status = rep(c("Native", "Non-native"), each = length(C_vals)),
n = c(native_counts, non_native_counts)
) |>
mutate(status = factor(status, levels = c("Native","Non-native")))
# Chequeo de totales (revísalos con tus sumas)
df_period  |> group_by(period) |> summarise(total = sum(n))
df_status  |> group_by(status) |> summarise(total = sum(n))
# --- 3) Estilo ---------------------------------------------
pal_period <- c("Before (1840–1880)" = "#C08C8C", "After (1960–2000)" = "#E8CF8C")
theme_thesis <- theme_minimal(base_size = 13) +
theme(
plot.title    = element_text(face="bold", hjust=0.5, margin=margin(b=6)),
plot.subtitle = element_text(hjust=0.5, color="#555", margin=margin(b=10)),
axis.title.y  = element_text(margin=margin(r=8)),
axis.text.x   = element_text(face="bold"),
panel.grid.major.y = element_line(linetype="dashed", color="gray55", linewidth=0.7),
panel.grid.minor = element_blank(),
legend.position = "top",
legend.title = element_blank(),
plot.background = element_rect(fill = "#F0F4F8", color = NA)
)
# --- 4) Figuras --------------------------------------------
# A) Barras lado a lado por periodo
p_c_bars <- ggplot(df_period, aes(x = factor(C), y = n, fill = period)) +
geom_col(position = position_dodge(width = 0.8), width = 0.7, color = "white") +
geom_text(aes(label = n),
position = position_dodge(width = 0.8), vjust = -0.35, size = 3.2) +
scale_fill_manual(values = pal_period) +
labs(title = "C value distribution by period",
subtitle = "Before (1840–1880) vs After (1960–2000)",
x = "C value", y = "Count") +
theme_thesis
theme_thesis
# (Opcional) C value por estatus
pal_status <- c("Native"="#9FD29F", "Non-native"="#79B7FF")
p_c_status <- ggplot(df_status, aes(x = factor(C), y = n, fill = status)) +
geom_col(position = position_dodge(width = 0.8), width = 0.7, color = "white") +
geom_text(aes(label = n),
position = position_dodge(width = 0.8), vjust = -0.35, size = 3.2) +
scale_fill_manual(values = pal_status) +
labs(title = "C value distribution by status",
subtitle = "Native vs Non-native",
x = "C value", y = "Count") +
theme_thesis
# Mostrar
p_c_bars
p_c_lines
p_c_status  # comenta si no quieres esta tercera figura
# --- 1) Ingreso de datos -----------------------------------
C_vals <- 0:10
# Periodos (de tu tabla; vacíos tratados como 0)
before_counts <- c(9, 0, 1, 2, 0, 3, 2, 7, 4, 6, 0)   # C=0..10
after_counts  <- c(37,0,10,1,11,6,11,12,7,6,2)      # C=0..10
# Estatus (de tu tabla; vacíos tratados como 0)
native_counts     <- c(0,0,10,3,11,9,13,19,11,12,1)  # C=0..10
non_native_counts <- c(46,1,0,0,0,0,0,0,0,0,1)       # C=0..10
# --- 2) Data frames "tidy" ---------------------------------
df_period <- tibble(
C = rep(C_vals, 2),
period = rep(c("Before (1840–1880)", "After (1960–2000)"), each = length(C_vals)),
n = c(before_counts, after_counts)
) |>
mutate(period = factor(period, levels = c("Before (1840–1880)", "After (1960–2000)")))
df_status <- tibble(
C = rep(C_vals, 2),
status = rep(c("Native", "Non-native"), each = length(C_vals)),
n = c(native_counts, non_native_counts)
) |>
mutate(status = factor(status, levels = c("Native","Non-native")))
# Chequeo de totales (revísalos con tus sumas)
df_period  |> group_by(period) |> summarise(total = sum(n))
df_status  |> group_by(status) |> summarise(total = sum(n))
# --- 3) Estilo ---------------------------------------------
pal_period <- c("Before (1840–1880)" = "#C08C8C", "After (1960–2000)" = "#E8CF8C")
theme_thesis <- theme_minimal(base_size = 13) +
theme(
plot.title    = element_text(face="bold", hjust=0.5, margin=margin(b=6)),
plot.subtitle = element_text(hjust=0.5, color="#555", margin=margin(b=10)),
axis.title.y  = element_text(margin=margin(r=8)),
axis.text.x   = element_text(face="bold"),
panel.grid.major.y = element_line(linetype="dashed", color="gray55", linewidth=0.7),
panel.grid.minor = element_blank(),
legend.position = "top",
legend.title = element_blank(),
plot.background = element_rect(fill = "#F0F4F8", color = NA)
)
# --- 4) Figuras --------------------------------------------
# A) Barras lado a lado por periodo
p_c_bars <- ggplot(df_period, aes(x = factor(C), y = n, fill = period)) +
geom_col(position = position_dodge(width = 0.8), width = 0.7, color = "white") +
geom_text(aes(label = n),
position = position_dodge(width = 0.8), vjust = -0.35, size = 3.2) +
scale_fill_manual(values = pal_period) +
labs(title = "C value distribution by period",
subtitle = "Before (1840–1880) vs After (1960–2000)",
x = "C value", y = "Count") +
theme_thesis
theme_thesis
# (Opcional) C value por estatus
pal_status <- c("Native"="#9FD29F", "Non-native"="#79B7FF")
p_c_status <- ggplot(df_status, aes(x = factor(C), y = n, fill = status)) +
geom_col(position = position_dodge(width = 0.8), width = 0.7, color = "white") +
geom_text(aes(label = n),
position = position_dodge(width = 0.8), vjust = -0.35, size = 3.2) +
scale_fill_manual(values = pal_status) +
labs(title = "C value distribution by status",
subtitle = "Native vs Non-native",
x = "C value", y = "Count") +
theme_thesis
# Mostrar
p_c_bars
p_c_status  # comenta si no quieres esta tercera figura
# --- Chi-square 2×2: Period (Before/After) × Status (Native/Non-native) ----
# Convertimos tu df "largo" a matriz 2x2
tab_2x2 <- df |>
tidyr::pivot_wider(names_from = status, values_from = n) |>
dplyr::arrange(period)
m <- as.matrix(tab_2x2[, c("Native", "Non-native")])
rownames(m) <- tab_2x2$period
m
#           Native Non-native
# Before...    25          9
# After ...    65         38
# Chi-square con corrección de Yates (estándar en tablas 2x2)
chisq_yates  <- stats::chisq.test(m)                # correct = TRUE por defecto
# (opcional) sin corrección
chisq_nocorr <- stats::chisq.test(m, correct = FALSE)
# Tamaño de efecto (Cramér's V; en 2x2 es |phi|)
cramers_v <- sqrt(unname(chisq_yates$statistic) / sum(m))
# Helper para formatear p-values
fmt_p <- function(p) ifelse(p < .001, "< 0.001", sprintf("%.3f", p))
# --- Añadir el resultado como caption a tu gráfico -------------
cap <- sprintf(
"Chi-square (Yates): \u03C7\u00B2 = %.2f, df = %d, p = %s. Cramer's V = %.2f.",
unname(chisq_yates$statistic), unname(chisq_yates$parameter),
fmt_p(chisq_yates$p.value), cramers_v
)
graph1 <- graph1 + ggplot2::labs(caption = cap)
graph1
# --- Chi-square 2×2: Period (Before/After) × Status (Native/Non-native) ----
# Convertimos tu df "largo" a matriz 2x2
tab_2x2 <- df |>
tidyr::pivot_wider(names_from = status, values_from = n) |>
dplyr::arrange(period)
m <- as.matrix(tab_2x2[, c("Native", "Non-native")])
rownames(m) <- tab_2x2$period
m
#           Native Non-native
# Before...    25          9
# After ...    65         38
# Chi-square con corrección de Yates (estándar en tablas 2x2)
chisq_yates  <- stats::chisq.test(m)                # correct = TRUE por defecto
# (opcional) sin corrección
chisq_nocorr <- stats::chisq.test(m, correct = FALSE)
# Tamaño de efecto (Cramér's V; en 2x2 es |phi|)
cramers_v <- sqrt(unname(chisq_yates$statistic) / sum(m))
# Helper para formatear p-values
fmt_p <- function(p) ifelse(p < .001, "< 0.001", sprintf("%.3f", p))
# --- Añadir el resultado como caption a tu gráfico -------------
cap <- sprintf(
"Chi-square (Yates): \u03C7\u00B2 = %.2f, df = %d, p = %s. Cramer's V = %.2f.",
unname(chisq_yates$statistic), unname(chisq_yates$parameter),
fmt_p(chisq_yates$p.value), cramers_v
)
tab_2x2 <- df |>
tidyr::pivot_wider(names_from = status, values_from = n) |>
dplyr::arrange(period) |>
dplyr::select(Native, `Non-native`) |>
as.matrix()
chisq.test(tab_2x2)            # Chi-square 2x2 con corrección de Yates
# chisq.test(tab_2x2, correct = FALSE)  # (opcional) sin corrección
pal <- c("Native"="darkseagreen3","Non-native"="steelblue1")
theme_thesis <- ggplot2::theme_minimal(base_size = 13) +
ggplot2::theme(
plot.title      = ggplot2::element_text(face = "bold", margin = ggplot2::margin(b = 3)),
plot.subtitle   = ggplot2::element_text(color = "#555555", margin = ggplot2::margin(b = 10),  hjust = 0.5),
plot.caption    = ggplot2::element_text(size = 10, color = "#6B6B6B"),
axis.title.y    = ggplot2::element_text(margin = ggplot2::margin(r = 8)),
axis.text.x     = ggplot2::element_text(face = "bold"),
panel.grid.minor= ggplot2::element_blank(),
panel.grid.major.x = ggplot2::element_blank(),
legend.position = "top",
legend.text     = ggplot2::element_text(size = 12),
plot.background = ggplot2::element_rect(fill = "aliceblue", color = NA)
)
graph1 <- ggplot2::ggplot(df, ggplot2::aes(x = period, y = n, fill = status)) +
ggplot2::geom_col(width = 0.75, color = "white") +
ggplot2::geom_text(ggplot2::aes(label = n), position = ggplot2::position_stack(vjust = 0.5), size = 3.8) +
ggplot2::scale_fill_manual(values = pal) +
ggplot2::labs(title = "Native and Non Native plants before and after the urbanization",
subtitle = "Pre urbanization vs Post urbanization",
x = NULL, y = "count" ) +
theme_thesis
graph1
C_vals <- 0:10
c_before <- rep(C_vals, times = before_counts)
c_after  <- rep(C_vals, times = after_counts)
t.test(c_before, c_after, var.equal = FALSE)  # Welch t-test
